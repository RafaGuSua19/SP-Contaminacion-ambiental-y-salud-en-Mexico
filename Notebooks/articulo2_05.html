<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jessica Dong">
<meta name="author" content="Ebony Valadez">
<meta name="author" content="Emiliano Guzmán">
<meta name="author" content="Rafael Gutiérrez">
<meta name="keywords" content="redes bayesianas gaussianas, bnlearn, contaminación del aire, codificación">

<title>Contaminación Ambiental y Salud en México</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="articulo2_05_files/libs/clipboard/clipboard.min.js"></script>
<script src="articulo2_05_files/libs/quarto-html/quarto.js"></script>
<script src="articulo2_05_files/libs/quarto-html/popper.min.js"></script>
<script src="articulo2_05_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="articulo2_05_files/libs/quarto-html/anchor.min.js"></script>
<link href="articulo2_05_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="articulo2_05_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="articulo2_05_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="articulo2_05_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="articulo2_05_files/libs/bootstrap/bootstrap-32162a2fca7cb0439643f2faaab1edf3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="header-section-number">1</span> Introducción</a></li>
  <li><a href="#metodología" id="toc-metodología" class="nav-link" data-scroll-target="#metodología"><span class="header-section-number">2</span> Metodología</a>
  <ul class="collapse">
  <li><a href="#construcción-de-la-base-de-datos" id="toc-construcción-de-la-base-de-datos" class="nav-link" data-scroll-target="#construcción-de-la-base-de-datos"><span class="header-section-number">2.1</span> Construcción de la base de datos</a></li>
  <li><a href="#redes-bayesianas-propuestas" id="toc-redes-bayesianas-propuestas" class="nav-link" data-scroll-target="#redes-bayesianas-propuestas"><span class="header-section-number">2.2</span> Redes bayesianas propuestas</a>
  <ul class="collapse">
  <li><a href="#dag-1-propuesta-por-el-nutriólogo-y-especialista-en-ciencias-médicas-alberto-bricio." id="toc-dag-1-propuesta-por-el-nutriólogo-y-especialista-en-ciencias-médicas-alberto-bricio." class="nav-link" data-scroll-target="#dag-1-propuesta-por-el-nutriólogo-y-especialista-en-ciencias-médicas-alberto-bricio."><span class="header-section-number">2.2.1</span> DAG 1: Propuesta por el nutriólogo y especialista en ciencias médicas Alberto Bricio.</a></li>
  <li><a href="#dag-2-propuesta-por-el-biomédico-y-phd-candidate-en-human-genetics-asbiel-garibaldi." id="toc-dag-2-propuesta-por-el-biomédico-y-phd-candidate-en-human-genetics-asbiel-garibaldi." class="nav-link" data-scroll-target="#dag-2-propuesta-por-el-biomédico-y-phd-candidate-en-human-genetics-asbiel-garibaldi."><span class="header-section-number">2.2.2</span> DAG 2: Propuesta por el biomédico y PhD candidate en human genetics Asbiel Garibaldi.</a></li>
  <li><a href="#dag-3-propuesta-por-el-médico-geriatra-jesús-francisco-gutiérrez-suárez." id="toc-dag-3-propuesta-por-el-médico-geriatra-jesús-francisco-gutiérrez-suárez." class="nav-link" data-scroll-target="#dag-3-propuesta-por-el-médico-geriatra-jesús-francisco-gutiérrez-suárez."><span class="header-section-number">2.2.3</span> DAG 3: Propuesta por el médico geriatra Jesús Francisco Gutiérrez Suárez.</a></li>
  </ul></li>
  <li><a href="#ajuste-de-cada-modelo-a-una-gbn-y-métricas-bic-y-aic" id="toc-ajuste-de-cada-modelo-a-una-gbn-y-métricas-bic-y-aic" class="nav-link" data-scroll-target="#ajuste-de-cada-modelo-a-una-gbn-y-métricas-bic-y-aic"><span class="header-section-number">2.3</span> Ajuste de cada modelo a una GBN y métricas BIC y AIC</a>
  <ul class="collapse">
  <li><a href="#selección-del-modelo" id="toc-selección-del-modelo" class="nav-link" data-scroll-target="#selección-del-modelo"><span class="header-section-number">2.3.1</span> Selección del modelo</a></li>
  </ul></li>
  <li><a href="#manejo-de-variables-categóricas-el-caso-de-sexo" id="toc-manejo-de-variables-categóricas-el-caso-de-sexo" class="nav-link" data-scroll-target="#manejo-de-variables-categóricas-el-caso-de-sexo"><span class="header-section-number">2.4</span> Manejo de variables categóricas: el caso de sexo</a></li>
  </ul></li>
  <li><a href="#aplicación" id="toc-aplicación" class="nav-link" data-scroll-target="#aplicación"><span class="header-section-number">3</span> Aplicación</a>
  <ul class="collapse">
  <li><a href="#ajuste-de-los-dags-y-cálculo-de-métricas-de-información" id="toc-ajuste-de-los-dags-y-cálculo-de-métricas-de-información" class="nav-link" data-scroll-target="#ajuste-de-los-dags-y-cálculo-de-métricas-de-información"><span class="header-section-number">3.1</span> Ajuste de los DAGs y cálculo de métricas de información</a></li>
  <li><a href="#análisis-de-queries-y-predicciones" id="toc-análisis-de-queries-y-predicciones" class="nav-link" data-scroll-target="#análisis-de-queries-y-predicciones"><span class="header-section-number">3.2</span> Análisis de queries y predicciones</a></li>
  <li><a href="#análisis-por-sexo-estratificación" id="toc-análisis-por-sexo-estratificación" class="nav-link" data-scroll-target="#análisis-por-sexo-estratificación"><span class="header-section-number">3.3</span> Análisis por sexo (estratificación)</a></li>
  <li><a href="#modelos-no-paramétricos-y-comparación-aicbic" id="toc-modelos-no-paramétricos-y-comparación-aicbic" class="nav-link" data-scroll-target="#modelos-no-paramétricos-y-comparación-aicbic"><span class="header-section-number">3.4</span> Modelos no paramétricos y comparación AIC/BIC</a>
  <ul class="collapse">
  <li><a href="#resultado-principal" id="toc-resultado-principal" class="nav-link" data-scroll-target="#resultado-principal"><span class="header-section-number">3.4.1</span> 4.2. Resultado principal</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#resultados" id="toc-resultados" class="nav-link" data-scroll-target="#resultados"><span class="header-section-number">4</span> Resultados</a>
  <ul class="collapse">
  <li><a href="#resultados-de-bic-y-aic" id="toc-resultados-de-bic-y-aic" class="nav-link" data-scroll-target="#resultados-de-bic-y-aic"><span class="header-section-number">4.1</span> Resultados de BIC y AIC</a></li>
  <li><a href="#resultados-de-queries-probabilísticas" id="toc-resultados-de-queries-probabilísticas" class="nav-link" data-scroll-target="#resultados-de-queries-probabilísticas"><span class="header-section-number">4.2</span> Resultados de queries probabilísticas</a>
  <ul class="collapse">
  <li><a href="#consulta-1-proteína-c-reactiva-vs-pm_2.5" id="toc-consulta-1-proteína-c-reactiva-vs-pm_2.5" class="nav-link" data-scroll-target="#consulta-1-proteína-c-reactiva-vs-pm_2.5"><span class="header-section-number">4.2.1</span> Consulta 1 · Proteína C Reactiva vs <strong><span class="math inline">\(PM_{2.5}\)</span></strong></a></li>
  <li><a href="#consulta-2-glucosa-y-contaminante-del-aire" id="toc-consulta-2-glucosa-y-contaminante-del-aire" class="nav-link" data-scroll-target="#consulta-2-glucosa-y-contaminante-del-aire"><span class="header-section-number">4.2.2</span> Consulta 2 · Glucosa y contaminante del aire</a></li>
  <li><a href="#consulta-3-colesterol-total-y-so₂" id="toc-consulta-3-colesterol-total-y-so₂" class="nav-link" data-scroll-target="#consulta-3-colesterol-total-y-so₂"><span class="header-section-number">4.2.3</span> Consulta 3 · Colesterol total y SO₂</a></li>
  </ul></li>
  <li><a href="#comparación-de-modelos-por-sexo" id="toc-comparación-de-modelos-por-sexo" class="nav-link" data-scroll-target="#comparación-de-modelos-por-sexo"><span class="header-section-number">4.3</span> Comparación de modelos por sexo</a></li>
  </ul></li>
  <li><a href="#resultados-1" id="toc-resultados-1" class="nav-link" data-scroll-target="#resultados-1"><span class="header-section-number">5</span> Resultados</a></li>
  <li><a href="#conclusiones" id="toc-conclusiones" class="nav-link" data-scroll-target="#conclusiones"><span class="header-section-number">6</span> Conclusiones</a></li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias"><span class="header-section-number">7</span> Referencias</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Otros formatos</h2><ul><li><a href="articulo2_05.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Contaminación Ambiental y Salud en México</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Código</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autores/as</div>
    <div class="quarto-title-meta-contents">
             <p>Jessica Dong </p>
             <p>Ebony Valadez </p>
             <p>Emiliano Guzmán </p>
             <p>Rafael Gutiérrez </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">7 de septiembre de 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Resumen</div>
    <p>Este proyecto explora la relación entre la exposición a contaminantes ambientales y la salud de la población mexicana. Utilizando datos de la Encuesta Nacional de Salud y Nutrición (ENSANUT) 2022 y datos de calidad del aire de SEMARNAT, se construye y evalúa un modelo de Redes Bayesianas Graussianas (GBN). La estructura de la red se propone con base en la opinión de especialistas en el área, validando su desempeño individual con métricas como las pruebas BIC y AIC. El modelo resultante se utiliza para responder a preguntas de investigación sobre cómo la exposición a contaminantes impacta en biomarcadores específicos. Los hallazgos buscan contribuir a una mejor comprensión de los factores que influyen en la salud pública y a informar estrategias para mitigar los efectos de la contaminación atmosférica.</p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Palabras clave</div>
    <p>redes bayesianas gaussianas, bnlearn, contaminación del aire, codificación</p>
  </div>
</div>

</header>


<section id="introducción" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introducción</h1>
<p>Este proyecto de investigación se enfoca en analizar la <strong>relación entre los contaminantes atmosféricos y sus efectos en la salud humana en México</strong>. A través de este artículo se busca identificar y cuantificar la influencia de los factores ambientales sobre biomarcadores específicos en la población mexicana.</p>
<p>Para ello, se integraron conjuntos de datos de fuentes gubernamentales confiables. Los datos de la <strong>Encuesta Nacional de Salud y Nutrición (ENSANUT) 2022</strong> proporcionan información socio-demográfica y biológica detallada sobre la muestra de estudio. Esta información se complementa con datos de <strong>calidad del aire actualizados de la SEMARNAT</strong>.</p>
<p>La metodología con la que se aborda este artículo consiste en la construcción de <strong>Redes Bayesianas Gaussianas (GBN)</strong>, con las que será posible representar y analizar las complejas relaciones de dependencia entre las variables. Con la colaboración de expertos en medicina y química, se validarán y construirán al menos tres estructuras de red distintas. Para comparar su rendimiento, se evaluará su calidad con métricas como el BIC y el AIC. Finalmente, se utilizará el modelo más robusto para responder a preguntas clave de interés sobre la salud pública, lo que podría contribuir al desarrollo de futuras políticas de salud y medio ambiente.</p>
</section>
<section id="metodología" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Metodología</h1>
<section id="construcción-de-la-base-de-datos" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="construcción-de-la-base-de-datos"><span class="header-section-number">2.1</span> Construcción de la base de datos</h2>
<p>Se crearon dos dataframes a partir de los datos originales: <strong>demográfico</strong>, con información socio-demográfica como folio, estrato, región y entidad/municipio, y <strong>sangre</strong>, con folio y distintos biomarcadores. Estos se unen mediante la columna de folio que tienen en común, combinando datos demográficos y de biomarcadores de sangre por persona. Después, se filtró el archivo de calidad del aire para limpiar y estandarizan los nombres de entidad y municipio y que coincidan con el formato de los datos ambientales. Finalmente, se unieron los datos de los biomarcadores y la calidad del aire por entidad y municipio, obteniendo el dataframe final, que integra información socio-demográfica, biomarcadores sanguíneos y calidad del aire listos para el análisis.</p>
<p>Se realizó la limpieza de los datos mediante la transformación de variables a formato numérico y la corrección de valores atípicos. Debido a que más de 15 variables importantes para las estructuras DAG presentaban datos faltantes, y muchas tenían más del 50% de información incompleta, no era posible eliminar observaciones. Por ello, se optó por la <strong>imputación con la mediana</strong>, de manera que se pudieran utilizar para el análisis posterior.</p>
</section>
<section id="redes-bayesianas-propuestas" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="redes-bayesianas-propuestas"><span class="header-section-number">2.2</span> Redes bayesianas propuestas</h2>
<p>Se consultó a tres expertos en áreas de la salud y bioquímica, quienes contribuyeron al proyecto proporcionando su conocimiento especializado para proponer estructuras DAG que representaran las posibles relaciones de dependencia entre las variables. Gracias a estas entrevistas, se obtuvieron tres redes diferentes, reflejando distintas perspectivas sobre las interacciones entre los indicadores de salud, factores demográficos y ambientales. Las variables que se utilizaron para plantear los modelos DAG son las siguientes:</p>
<pre><code>desc_ent1           = entidad
desc_mun1           = municipio
h0302               = sexo
h0303               = edad
estrato             = estrato
region              = region
hb02                = hemoglobina
valor_AC_URICO      = acido_urico
valor_ALBU          = albumina
valor_COL_HDL       = col_hdl
valor_COL_LDL       = colo_ldl
valor_COLEST        = colesterol_total
valor_CREAT         = creatinina
valor_GLU_SUERO     = glucosa
valor_INSULINA      = insulina
valor_PCR           = proteina_cr
valor_TRIG          = trigliceridos
valor_HB1AC         = hemoglobina_glucos
valor_FERRITINA     = ferritina
valor_FOL           = folato
valor_HCST          = homocistenia
valor_STFR_FEB23    = receptor_transferrr
valor_VIT_B12       = vit_b12
valor_VIT_D         = vit_d
SO_2                = SO_2
CO                  = CO
NOx                 = NOx
COV                 = COV
PM_010              = PM_010
PM_2_5              = PM_2_5
NH_3                = NH_3</code></pre>
<section id="dag-1-propuesta-por-el-nutriólogo-y-especialista-en-ciencias-médicas-alberto-bricio." class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="dag-1-propuesta-por-el-nutriólogo-y-especialista-en-ciencias-médicas-alberto-bricio."><span class="header-section-number">2.2.1</span> DAG 1: Propuesta por el nutriólogo y especialista en ciencias médicas Alberto Bricio.</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="dag_1.png" class="img-fluid figure-img"></p>
<figcaption>Grafo acíclico dirigido 1</figcaption>
</figure>
</div>
<p>En esta estructura las variables socio-demográficas, como el sexo y la edad, influyen directamente en los biomarcadores. Por ejemplo, la producción de hemoglobina ocurre en función del sexo y el <span class="math inline">\(PM_{10}\)</span> se relaciona con la densidad de población, representada por el estrato social. Se postula que la exposición a contaminantes atmosféricos como el <span class="math inline">\(SO_2\)</span> y el <span class="math inline">\(CO\)</span> influye directamente en la salud. El <span class="math inline">\(SO_2\)</span> se asocia con el nivel de proteína C reactiva y homocisteína, mientras que el <span class="math inline">\(CO\)</span> impacta en los niveles de albúmina. Finalmente, estas interacciones se reflejan en la salud metabólica y nutricional: la albúmina y la insulina influyen en la hemoglobina glicosilada y el colesterol total, mientras que la edad y la región se relacionan con los niveles de vitamina D.</p>
</section>
<section id="dag-2-propuesta-por-el-biomédico-y-phd-candidate-en-human-genetics-asbiel-garibaldi." class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="dag-2-propuesta-por-el-biomédico-y-phd-candidate-en-human-genetics-asbiel-garibaldi."><span class="header-section-number">2.2.2</span> DAG 2: Propuesta por el biomédico y PhD candidate en human genetics Asbiel Garibaldi.</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="dag_2.png" class="img-fluid figure-img"></p>
<figcaption>Grafo acíclico dirigido 2</figcaption>
</figure>
</div>
<p>En la segunda estructura se explora la relación entre la exposición a contaminantes ambientales, el estilo de vida, los factores socio-demográficos y los biomarcadores de salud obtenidos mediante muestras de sangre. Se propone que la contaminación del aire por partículas finas (<span class="math inline">\(PM_{2.5}\)</span>​ y <span class="math inline">\(PM_{10}\)</span>​) causa un perfil inflamatorio en el cuerpo, lo que se refleja en niveles elevados de proteína C reactiva. A largo plazo, esta inflamación crónica podría influir en los niveles de hemoglobina glicosilada.</p>
<p>Además, se plantea que la exposición a óxidos de nitrógeno (<span class="math inline">\(NOx\)</span>​) y dióxido de azufre (<span class="math inline">\(SO_2\)</span>​) genera estrés oxidativo que eleva la homocisteína y exacerba los procesos inflamatorios. Por otro lado, la exposición al monóxido de carbono (<span class="math inline">\(CO\)</span>) afecta la oxigenación, lo que se refleja en una disminución de la hemoglobina y en la función renal, evaluada con la creatinina.</p>
<p>En cuanto a los factores de estilo de vida, la dieta juega un papel crucial. Se propone que el consumo de carne roja está asociado con niveles elevados de ácido úrico, mientras que una dieta alta en grasas se correlaciona con el colesterol y los triglicéridos. Un consumo bajo de frutas y verduras se refleja en niveles deficientes de folato, vitamina B12 y vitamina D. La edad y el sexo también se consideran aspectos relevantes en el desarrollo de enfermedades: la edad se relaciona directamente con los niveles de glucosa e insulina, mientras que el sexo influye en la ferritina y la hemoglobina. Finalmente, se postula que vivir en zonas urbanas (representado por el estrato social) influye directamente en el perfil metabólico e inflamatorio debido a una mayor exposición a la contaminación.</p>
</section>
<section id="dag-3-propuesta-por-el-médico-geriatra-jesús-francisco-gutiérrez-suárez." class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="dag-3-propuesta-por-el-médico-geriatra-jesús-francisco-gutiérrez-suárez."><span class="header-section-number">2.2.3</span> DAG 3: Propuesta por el médico geriatra Jesús Francisco Gutiérrez Suárez.</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="dag_3.png" class="img-fluid figure-img"></p>
<figcaption>Grafo Acíclico Dirigido 3</figcaption>
</figure>
</div>
<p>Este modelo establece que las variables demográficas, como el sexo y la edad, son los nodos principales que influyen en los perfiles metabólicos, afectando directamente los niveles de colesterol LDL, colesterol total, triglicéridos y glucosa.</p>
<p>El modelo propone que la <strong>exposición a contaminantes del aire</strong>, como el monóxido de carbono (CO), el dióxido de azufre (<span class="math inline">\(SO_2\)</span>​) y el amoníaco (<span class="math inline">\(NH_3\)</span>​), está determinada por el estrato socioeconómico y la región. La <strong>hemoglobina</strong> es un biomarcador clave en esta estructura, ya que se encuentra en el centro de las dependencias, siendo influenciada por una combinación de factores ambientales (<span class="math inline">\(CO\)</span>, <span class="math inline">\(NOx\)</span>​), demográficos (sexo, edad, región) y nutricionales (ferritina, folato, vitamina B12). Finalmente, los indicadores de salud a largo plazo, como la <strong>hemoglobina glicosilada</strong>, dependen de las interacciones entre el sexo, la edad y los niveles de hemoglobina y glucosa.</p>
<p>En resumen, los tres modelos de DAGs coinciden en estructurar las variables sociodemográficas como puntos de partida, de modo que sexo, edad y región siempre aparecen como nodos iniciales, y en todos los casos se observa que variables metabólicas como glucosa, colesterol total, hemoglobina o insulina son consideradas desenlaces intermedios o finales. Sin embargo, difieren en cómo se asignan los papeles de mediación: por ejemplo, en un modelo <em>estrato</em> funciona como nexo entre municipio y hemoglobina, reflejando un interés en capturar determinantes sociales de la salud; mientras que en otro se enfatiza la ruta bioquímica al ligar proteína C reactiva con glucosa y colesterol, sugiriendo una perspectiva más biomédica que prioriza la inflamación como factor central. De forma similar, un modelo coloca a la albúmina como variable puente entre <span class="math inline">\(CO\)</span> y hemoglobina glicosilada, mientras que en otro este rol lo asume la insulina, mostrando dos formas distintas de concebir la relación entre metabolismo energético y marcadores de función hepática. Estas diferencias probablemente se deben a que cada investigador pondera de manera distinta la evidencia previa: quienes priorizan variables sociales construyen DAGs más jerárquicos con capas de contexto (municipio, estrato), mientras que quienes priorizan la fisiología molecular trazan rutas más directas entre biomarcadores. En resumen, los puntos en común muestran un consenso en las variables clave, pero las divergencias reflejan enfoques disciplinarios y prioridades teóricas distintas.</p>
</section>
</section>
<section id="ajuste-de-cada-modelo-a-una-gbn-y-métricas-bic-y-aic" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="ajuste-de-cada-modelo-a-una-gbn-y-métricas-bic-y-aic"><span class="header-section-number">2.3</span> Ajuste de cada modelo a una GBN y métricas BIC y AIC</h2>
<p>A partir de cada DAG, se procedió a realizar su ajuste a una Red Bayesiana Gaussiana utilizando la librería <code>bnlearn</code> de R. Sin embargo, en este lenguaje las GBN solo pueden ajustarse con variables continuas; no es posible incluir directamente variables discretas como sexo, estrato o región. Por ello, los intentos de ajustar una GBN con estas variables fallaron, y los criterios de información Bayesiano y de Akaike (BIC y AIC) solo funcionan para nodos continuos. Estas redes están diseñadas para trabajar con variables que siguen una distribución gaussiana, es decir, continuas. Los modelos DAG que se propusieron tienen condicionales gaussianas mixtas, las CG-BN (condicionales gaussianas mixtas) en <code>bnlearn</code> no son soportadas para ajuste automático con variables discretas, al menos sin usar paquetes avanzados.</p>
<p>Ante lo anterior, se convirtieron las variables discretas en un factor, aunque esto no cambia el hecho de que su naturaleza es categórica. Ya que los modelos GBN puros asumen que todas las relaciones entre las variables son lineales y pueden ser representadas por regresiones lineales, lo que no es posible con variables discretas o categóricas, probar esta técnica tampoco produjo buenos resultados. Después de una investigación más exhaustiva, se encontró que los intentos de ajustar las estructuras DAG propuestas directamente como una GBN pura fallarán en R porque incluyen variables categóricas, y los criterios de información BIC o AIC no son compatibles con nodos discretos, lo que hace necesario explorar enfoques más avanzados o alternativos para el análisis.</p>
<section id="selección-del-modelo" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="selección-del-modelo"><span class="header-section-number">2.3.1</span> Selección del modelo</h3>
<p>Al comparar los valores obtenidos, se eligió el <strong>Modelo 2</strong>, ya que presentó el <strong>BIC y AIC más alto</strong>, lo que indica un mejor equilibrio entre ajuste del modelo y complejidad.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="dag_seleccionada.png" class="img-fluid figure-img"></p>
<figcaption>Grafo acíclico dirigido seleccionado</figcaption>
</figure>
</div>
<p>Este modelo refleja relaciones plausibles desde un punto de vista epidemiológico:</p>
<ul>
<li><strong>Edad</strong> influye en biomarcadores como colesterol total, ácido úrico, triglicéridos y creatinina, además de estar relacionada con glucosa, insulina y vitamina D.<br>
</li>
<li><strong>Municipio</strong> concentra las conexiones con contaminantes ambientales (<span class="math inline">\(CO\)</span>, <span class="math inline">\(NOx\)</span>, <span class="math inline">\(SO_2\)</span>, <span class="math inline">\(PM_{10}\)</span>, <span class="math inline">\(PM_{2.5}\)</span>) y micronutrientes (folato, vitamina B12), reflejando la variación espacial de exposición y condiciones ambientales.<br>
</li>
<li>Variables como <strong>hemoglobina glicosilada</strong> y <strong>proteína C-reactiva</strong> aparecen al final de la red, recibiendo influencias de varios factores metabólicos y ambientales, lo que sugiere su papel como posibles variables de resultado o integración de riesgos.</li>
</ul>
<p>En conjunto, la estructura del Modelo 2 muestra cómo las características demográficas (edad) y contextuales (municipio) actúan como determinantes principales sobre los biomarcadores de salud, lo que refuerza su pertinencia como modelo seleccionado.</p>
</section>
</section>
<section id="manejo-de-variables-categóricas-el-caso-de-sexo" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="manejo-de-variables-categóricas-el-caso-de-sexo"><span class="header-section-number">2.4</span> Manejo de variables categóricas: el caso de sexo</h2>
<p>Uno de los principales retos al construir redes bayesianas gaussianas con datos reales es la inclusión de variables categóricas, como sexo, región o estrato. Estos modelos están diseñados para trabajar con variables continuas, por lo que no es posible incluir directamente variables discretas sin perder validez estadística o recurrir a técnicas más avanzadas.</p>
<p>En este trabajo, fueron exploradas distintas alternativas para abordar este problema, ya que el sexo es una variable central por requerimiento de la tarea. Primero, se intentó discretizar variables continuas y convertir las categóricas en factores, pero esto no resolvió la incompatibilidad con la GBN pura. También se revisó la literatura sobre métodos mixtos, como el modelo condicional gaussiano (CLG) y otros enfoques más complejos, aunque no fueron implementados en este análisis por su mayor complejidad y restricciones de software.</p>
<p>Finalmente, para poder analizar la influencia del sexo y cumplir con el objetivo de comparar diferencias por género, se decidió <strong>estratificar la base de datos</strong>, ajustando una red separada para hombres y otra para mujeres. Esta estrategia, aunque sencilla, permitió identificar posibles diferencias en la estructura y los parámetros del modelo según sexo; sin embargo, también limita la posibilidad de analizar interacciones conjuntas entre variables categóricas y continuas.</p>
<p>En resumen, la imposibilidad de incluir variables categóricas en las GBN con <code>bnlearn</code> concluyó en comparar subgrupos por separado. Dentro del equipo se reconoce que existen alternativas metodológicas para integrar datos mixtos en redes bayesianas, pero cada una implica distintas limitaciones y complejidades.</p>
</section>
</section>
<section id="aplicación" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Aplicación</h1>
<section id="ajuste-de-los-dags-y-cálculo-de-métricas-de-información" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="ajuste-de-los-dags-y-cálculo-de-métricas-de-información"><span class="header-section-number">3.1</span> Ajuste de los DAGs y cálculo de métricas de información</h2>
<p>Las tres estructuras DAG propuestas inicialmente fueron ajustadas como Redes Bayesianas Gaussianas (GBN).<br>
Debido a las limitaciones ya mencionadas —específicamente, la imposibilidad de incluir variables categóricas en un modelo GBN con <code>bnlearn</code>— fue necesario <strong>eliminar las variables <code>estrato</code>, <code>región</code> y <code>sexo</code></strong>, manteniendo únicamente <strong>edad</strong> y <strong>municipio</strong> como nodos válidos para el ajuste.</p>
<p>Con estas variables continuas se procedió a calcular los criterios de información <strong>BIC (Bayesian Information Criterion)</strong> y <strong>AIC (Akaike Information Criterion)</strong> para cada una de las tres redes propuestas.</p>
</section>
<section id="análisis-de-queries-y-predicciones" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="análisis-de-queries-y-predicciones"><span class="header-section-number">3.2</span> Análisis de queries y predicciones</h2>
<p>Con el modelo seleccionado se implementaron <strong>consultas probabilísticas (queries)</strong> mediante la función <code>cpquery</code> de <code>bnlearn</code>.<br>
El objetivo fue estimar <strong>probabilidades condicionales</strong> de variables de interés en presencia de ciertas condiciones ambientales o demográficas.</p>
<p>Para cada consulta:<br>
- Se definió un <strong>evento de interés clínico o epidemiológico</strong> (ej. proteína C reactiva elevada, glucosa alta, colesterol elevado).<br>
- Se establecieron las condiciones de <strong>evidencia</strong> (ej. exposición a contaminantes como <span class="math inline">\(PM_{2.5}\)</span>, <span class="math inline">\(NOx\)</span> o <span class="math inline">\(SO_{2}\)</span>, o pertenecer a un grupo de edad).<br>
- Se utilizó el método de <strong>simulación</strong> con al menos <span class="math inline">\(10^6\)</span> muestras (<code>n = 10^6</code>), lo que permitió obtener estimaciones robustas y estables de las probabilidades condicionales.</p>
</section>
<section id="análisis-por-sexo-estratificación" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="análisis-por-sexo-estratificación"><span class="header-section-number">3.3</span> Análisis por sexo (estratificación)</h2>
<p>Con el objetivo de cumplir el requerimiento de comparar diferencias por sexo, la base de datos se dividió en dos subconjuntos: hombres y mujeres. Se ajustó una red bayesiana gaussiana por separado para cada grupo, utilizando la misma estructura DAG y las variables continuas seleccionadas. Para ambos modelos se calcularon los valores de BIC y AIC, así como los parámetros estimados de cada nodo, facilitando la comparación directa entre sexos.</p>
</section>
<section id="modelos-no-paramétricos-y-comparación-aicbic" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="modelos-no-paramétricos-y-comparación-aicbic"><span class="header-section-number">3.4</span> Modelos no paramétricos y comparación AIC/BIC</h2>
<p>Fue respetada la estructura causal de la DAG y se sustituyó, nodo por nodo, los modelos lineales por <strong>modelos aditivos generalizados (GAM)</strong> usando <em>mgcv</em>. Para cada relación padre → hijo se especificó una función suave <code>s(·)</code> que permite no linealidades. Por ejemplo:</p>
<ul>
<li><code>vit_d ~ s(edad)</code><br>
</li>
<li><code>colesterol_total ~ s(edad)</code><br>
</li>
<li><code>CO ~ s(municipio)</code><br>
</li>
<li><code>proteina_cr ~ s(homocistenia) + s(PM_010) + s(PM_2_5)</code></li>
</ul>
<p>Asimismo, se mantuvieron los nodos raíz como intercepto (<code>edad ~ 1</code>). El nodo <strong>municipio</strong> se trató como exógeno (factor), sin modelarlo como respuesta.</p>
<p>Para evaluar el ajuste global de la red, fueron agregados los criterios de información <strong>nodo a nodo</strong> y se reportó:</p>
<p><span class="math display">\[
\text{BIC}_{\text{bnlearn}} \;=\; \ell(\hat{\theta}; \mathbf{x}) \;-\; \frac{k}{2}\log(n),
\]</span></p>
<p>Con esta convención, los valores <strong>más altos</strong> indican mejor ajuste penalizado (equivalente a menores AIC/BIC totales).</p>
<section id="resultado-principal" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="resultado-principal"><span class="header-section-number">3.4.1</span> 4.2. Resultado principal</h3>
<p>El ajuste no paramétrico obtuvo:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Modelo</th>
<th>(BIC)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DAG con modelos no paramétricos (GAM)</td>
<td>(-5,133,520)</td>
</tr>
<tr class="even">
<td>DAG con modelos paramétricos (lineales)</td>
<td>(-5,176,757)</td>
</tr>
</tbody>
</table>
<p>Por tanto, <strong>el BIC no mejoró</strong> al introducir suavizadores.</p>
</section>
</section>
</section>
<section id="resultados" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Resultados</h1>
<section id="resultados-de-bic-y-aic" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="resultados-de-bic-y-aic"><span class="header-section-number">4.1</span> Resultados de BIC y AIC</h2>
<p>Las tres estructuras DAG ajustadas fueron evaluadas con los criterios de información <strong>BIC</strong> y <strong>AIC</strong>, considerando únicamente las variables socio-demográficas continuas (<code>edad</code>, <code>municipio</code> y <code>entidad</code>), ya que <code>estrato</code>, <code>región</code> y <code>sexo</code> fueron eliminadas por los problemas ya explicados.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Modelo</th>
<th>BIC</th>
<th>AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DAG 1</td>
<td>-3324833</td>
<td>-3324649</td>
</tr>
<tr class="even">
<td>DAG 2</td>
<td>-5176757</td>
<td>-5176453</td>
</tr>
<tr class="odd">
<td>DAG 3</td>
<td>-3801911</td>
<td>-3801709</td>
</tr>
</tbody>
</table>
</section>
<section id="resultados-de-queries-probabilísticas" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="resultados-de-queries-probabilísticas"><span class="header-section-number">4.2</span> Resultados de queries probabilísticas</h2>
<section id="consulta-1-proteína-c-reactiva-vs-pm_2.5" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="consulta-1-proteína-c-reactiva-vs-pm_2.5"><span class="header-section-number">4.2.1</span> Consulta 1 · Proteína C Reactiva vs <strong><span class="math inline">\(PM_{2.5}\)</span></strong></h3>
<p><strong>Pregunta.</strong> ¿Cuál es la probabilidad de que una persona tenga <strong>proteína C reactiva &gt; 10 mg/L</strong> dado que la concentración de <strong><span class="math inline">\(PM_{2.5}\)</span> <span class="math inline">\(\leq\)</span> 155 μg/m³</strong>?</p>
<p><span class="math display">\[
\mathbb{P}\!\left(\text{proteina\_cr} &gt; 0.001 \;\middle|\; PM_{2.5} \leq 155 \,\mu\text{g}/\text{m}^3\right)
\]</span></p>
<hr>
</section>
<section id="consulta-2-glucosa-y-contaminante-del-aire" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="consulta-2-glucosa-y-contaminante-del-aire"><span class="header-section-number">4.2.2</span> Consulta 2 · Glucosa y contaminante del aire</h3>
<p><strong>Pregunta.</strong> ¿Cuál es la probabilidad de que una persona tenga <strong>glucosa en ayuno &gt; 126 mg/dL</strong> dado que es <strong>mayor o igual a 50 años</strong> y está expuesta a <strong>NOx &gt;= 40 ppb</strong>?</p>
<p><span class="math display">\[
\mathbb{P}\!\left(\mathrm{glucosa}&gt;126\ \text{mg/dL}\ \middle|\ \mathrm{edad}\geq 50,\ NOx&gt;=40\ \text{ppb}\right) = 0.1798456
\]</span></p>
<hr>
</section>
<section id="consulta-3-colesterol-total-y-so₂" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="consulta-3-colesterol-total-y-so₂"><span class="header-section-number">4.2.3</span> Consulta 3 · Colesterol total y SO₂</h3>
<p><strong>Pregunta.</strong> ¿Cuál es la probabilidad de que una persona tenga <strong>colesterol total &gt; 130 mg/dL</strong> dado un nivel de <strong>SO₂ &gt;= 80 ppb</strong>?</p>
<p><span class="math display">\[
\mathbb{P}\!\left(\mathrm{colesterol\_total}&gt;130\ \text{mg/dL}\ \middle|\ SO_2&gt;=80\ \text{ppb}\right) = 0.86975
\]</span></p>
</section>
</section>
<section id="comparación-de-modelos-por-sexo" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="comparación-de-modelos-por-sexo"><span class="header-section-number">4.3</span> Comparación de modelos por sexo</h2>
<ul>
<li><strong>BIC para hombres:</strong> -2,427,498<br>
</li>
<li><strong>BIC para mujeres:</strong> -2,748,215</li>
</ul>
<p>Se observaron diferencias en los parámetros de algunos nodos, como la influencia de la glucosa sobre la hemoglobina glicosilada, siendo mayor en mujeres que en hombres.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Parámetro</th>
<th>Hombres</th>
<th>Mujeres</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercepto</td>
<td>4.644663</td>
<td>4.485266</td>
</tr>
<tr class="even">
<td>Glucosa</td>
<td>0.008277</td>
<td>0.009983</td>
</tr>
<tr class="odd">
<td>Insulina</td>
<td>-0.000236</td>
<td>0.001297</td>
</tr>
<tr class="even">
<td>Proteína C reactiva (proteina_cr)</td>
<td>0.259740</td>
<td>0.251406</td>
</tr>
<tr class="odd">
<td>Sigma (desviación estándar)</td>
<td>0.486344</td>
<td>0.498629</td>
</tr>
</tbody>
</table>
<p>Estos resultados sugieren que, para un mismo aumento en la glucosa, el incremento esperado en la hemoglobina glicosilada es mayor en mujeres que en hombres, lo que podría estar relacionado con diferencias fisiológicas.</p>
</section>
</section>
<section id="resultados-1" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Resultados</h1>
<p>Para esta etapa se trabajó nuevamente con el <strong>DAG seleccionado</strong>, sin realizar comparaciones adicionales por sexo, ya que estas variables categóricas no forman parte del modelo ajustado.</p>
<p>Se aplicaron consultas probabilísticas para evaluar la relación entre biomarcadores y contaminantes ambientales, con los siguientes resultados:</p>
<p>La probabilidad estimada de que un individuo presente niveles elevados de proteína C reactiva bajo condiciones de PM₂.₅ menores o iguales a 155 μg/m³ es de <strong>82.3%</strong>. Esto indica que, incluso en escenarios donde la concentración de partículas finas se mantiene por debajo de este umbral, existe una alta probabilidad de respuesta inflamatoria medida por proteína C reactiva.</p>
<p>En personas de <strong>50 años o más</strong> expuestas a concentraciones de <span class="math inline">\(NOx\)</span> iguales o superiores a 40 ppb, la probabilidad de presentar glucosa en ayuno mayor a 126 mg/dL (umbral diagnóstico de diabetes) es de <strong>17.9%</strong>. Este resultado refleja un riesgo moderado que podría estar asociado a la combinación de edad avanzada y exposición a contaminantes.</p>
<p>La probabilidad de presentar colesterol total elevado en condiciones de exposición a <strong>SO₂ ≥ 80 ppb</strong> es de <strong>86.9%</strong>. Esto sugiere una fuerte asociación entre altos niveles de dióxido de azufre y alteraciones en el perfil lipídico, lo cual es relevante para el riesgo cardiovascular.</p>
</section>
<section id="conclusiones" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Conclusiones</h1>
<p>Para poder llevar a cabo experimientaciones con datos es de gran relevancia tener cierta noción sobre los datos con los que se están trabajando y con base en ello poder trazar los caminos más adecuados a seguir. En este caso, para la elaboración de este artículo, fue necesario la consulta con especialistas para así entender mejor las bases de datos con las que se trabaja y direccionar la investigación a un camino con mayor sentido, demostrando la suma importancia del trabajo colaborativo y multidisciplinario para la obtención de mejores resultados. El uso de redes bayesianas gaussianas permitió analizar la relación entre contaminantes ambientales y biomarcadores de salud en la población mexicana, a pesar de las limitaciones para incorporar variables categóricas de manera directa. La selección y ajuste de modelos reveló diferencias en la influencia de variables ambientales y demográficas sobre la salud, así como algunas variaciones por sexo. Estos resultados refuerzan la utilidad de los enfoques probabilísticos en salud pública y destacan la importancia de seguir explorando métodos más flexibles para integrar datos mixtos en futuros estudios.</p>
</section>
<section id="referencias" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Referencias</h1>
<p>Galera Capilla, M. I. (2020). Redes bayesianas: fundamentos teóricos y uso en R (Trabajo Fin de Grado, Universidad de Almería). Repositorio Institucional UAL. https://repositorio.ual.es/bitstream/handle/10835/19116/GALERA%20CAPILLA%2C%20MARIA%20ISABEL.pdf?sequence=1&amp;isAllowed=y</p>

<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Ejecutar el código</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb2" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Contaminación Ambiental y Salud en México"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Jessica Dong"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Ebony Valadez"</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Emiliano Guzmán"</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Rafael Gutiérrez "</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="an">lang:</span><span class="co"> es</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="an">abstract:</span><span class="co"> |</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"> Este proyecto explora la relación entre la exposición a contaminantes ambientales y la salud de la población mexicana. Utilizando datos de la Encuesta Nacional de Salud y Nutrición (ENSANUT) 2022 y datos de calidad del aire de SEMARNAT, se construye y evalúa un modelo de Redes Bayesianas Graussianas (GBN). La estructura de la red se propone con base en la opinión de especialistas en el área, validando su desempeño individual con métricas como las pruebas BIC y AIC. El modelo resultante se utiliza para responder a preguntas de investigación sobre cómo la exposición a contaminantes impacta en biomarcadores específicos. Los hallazgos buscan contribuir a una mejor comprensión de los factores que influyen en la salud pública y a informar estrategias para mitigar los efectos de la contaminación atmosférica.</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="an">keywords:</span><span class="co"> ["redes bayesianas gaussianas", "bnlearn", "contaminación del aire", "codificación"]</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: false       </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="an">crossref:</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">  fig-prefix: "Figura"</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">  tbl-prefix: "Tabla"</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">  eq-prefix: "Ecuación"</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co">    math: mathjax</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co">    documentclass: article</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co">    geometry: "margin=1in"</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-cap-location: bottom</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co">    tbl-cap-location: top</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introducción</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>Este proyecto de investigación se enfoca en analizar la **relación entre los contaminantes atmosféricos y sus efectos en la salud humana en México**. A través de este artículo se busca identificar y cuantificar la influencia de los factores ambientales sobre biomarcadores específicos en la población mexicana.</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>Para ello, se integraron conjuntos de datos de fuentes gubernamentales confiables. Los datos de la **Encuesta Nacional de Salud y Nutrición (ENSANUT) 2022** proporcionan información socio-demográfica y biológica detallada sobre la muestra de estudio. Esta información se complementa con datos de **calidad del aire actualizados de la SEMARNAT**.</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>La metodología con la que se aborda este artículo consiste en la construcción de **Redes Bayesianas Gaussianas (GBN)**, con las que será posible representar y analizar las complejas relaciones de dependencia entre las variables. Con la colaboración de expertos en medicina y química, se validarán y construirán al menos tres estructuras de red distintas. Para comparar su rendimiento, se evaluará su calidad con métricas como el BIC y el AIC. Finalmente, se utilizará el modelo más robusto para responder a preguntas clave de interés sobre la salud pública, lo que podría contribuir al desarrollo de futuras políticas de salud y medio ambiente.</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="fu"># Metodología</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## Construcción de la base de datos</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>Se crearon dos dataframes a partir de los datos originales: **demográfico**, con información socio-demográfica como folio, estrato, región y entidad/municipio, y **sangre**, con folio y distintos biomarcadores. Estos se unen mediante la columna de folio que tienen en común, combinando datos demográficos y de biomarcadores de sangre por persona. Después, se filtró el archivo de calidad del aire para limpiar y estandarizan los nombres de entidad y municipio y que coincidan con el formato de los datos ambientales. Finalmente, se unieron los datos de los biomarcadores y la calidad del aire por entidad y municipio, obteniendo el dataframe final, que integra información socio-demográfica, biomarcadores sanguíneos y calidad del aire listos para el análisis.</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>Se realizó la limpieza de los datos mediante la transformación de variables a formato numérico y la corrección de valores atípicos. Debido a que más de 15 variables importantes para las estructuras DAG presentaban datos faltantes, y muchas tenían más del 50% de información incompleta, no era posible eliminar observaciones. Por ello, se optó por la **imputación con la mediana**, de manera que se pudieran utilizar para el análisis posterior.</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="fu">## Redes bayesianas propuestas</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>Se consultó a tres expertos en áreas de la salud y bioquímica, quienes contribuyeron al proyecto proporcionando su conocimiento especializado para proponer estructuras DAG que representaran las posibles relaciones de dependencia entre las variables. Gracias a estas entrevistas, se obtuvieron tres redes diferentes, reflejando distintas perspectivas sobre las interacciones entre los indicadores de salud, factores demográficos y ambientales. Las variables que se utilizaron para plantear los modelos DAG son las siguientes:</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="in">desc_ent1           = entidad</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a><span class="in">desc_mun1           = municipio</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="in">h0302               = sexo</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="in">h0303               = edad</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="in">estrato             = estrato</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="in">region              = region</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="in">hb02                = hemoglobina</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="in">valor_AC_URICO      = acido_urico</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="in">valor_ALBU          = albumina</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="in">valor_COL_HDL       = col_hdl</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="in">valor_COL_LDL       = colo_ldl</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="in">valor_COLEST        = colesterol_total</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a><span class="in">valor_CREAT         = creatinina</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a><span class="in">valor_GLU_SUERO     = glucosa</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a><span class="in">valor_INSULINA      = insulina</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a><span class="in">valor_PCR           = proteina_cr</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a><span class="in">valor_TRIG          = trigliceridos</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a><span class="in">valor_HB1AC         = hemoglobina_glucos</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a><span class="in">valor_FERRITINA     = ferritina</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a><span class="in">valor_FOL           = folato</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="in">valor_HCST          = homocistenia</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a><span class="in">valor_STFR_FEB23    = receptor_transferrr</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a><span class="in">valor_VIT_B12       = vit_b12</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="in">valor_VIT_D         = vit_d</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="in">SO_2                = SO_2</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a><span class="in">CO                  = CO</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a><span class="in">NOx                 = NOx</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a><span class="in">COV                 = COV</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a><span class="in">PM_010              = PM_010</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a><span class="in">PM_2_5              = PM_2_5</span></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a><span class="in">NH_3                = NH_3</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a><span class="fu">### DAG 1:  Propuesta por el nutriólogo y especialista en ciencias médicas Alberto Bricio.</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a><span class="al">![Grafo acíclico dirigido 1](dag_1.png)</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>En esta estructura las variables socio-demográficas, como el sexo y la edad, influyen directamente en los biomarcadores. Por ejemplo, la producción de hemoglobina ocurre en función del sexo y el $PM_{10}$ se relaciona con la densidad de población, representada por el estrato social. Se postula que la exposición a contaminantes atmosféricos como el $SO_2$ y el $CO$ influye directamente en la salud. El $SO_2$ se asocia con el nivel de proteína C reactiva y homocisteína, mientras que el $CO$ impacta en los niveles de albúmina. Finalmente, estas interacciones se reflejan en la salud metabólica y nutricional: la albúmina y la insulina influyen en la hemoglobina glicosilada y el colesterol total, mientras que la edad y la región se relacionan con los niveles de vitamina D.</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a><span class="fu">### DAG 2: Propuesta por el biomédico y PhD candidate en human genetics Asbiel Garibaldi.</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a><span class="al">![Grafo acíclico dirigido 2](dag_2.png)</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>En la segunda estructura se explora la relación entre la exposición a contaminantes ambientales, el estilo de vida, los factores socio-demográficos y los biomarcadores de salud obtenidos mediante muestras de sangre. Se propone que la contaminación del aire por partículas finas ($PM_{2.5}$​ y $PM_{10}$​) causa un perfil inflamatorio en el cuerpo, lo que se refleja en niveles elevados de proteína C reactiva. A largo plazo, esta inflamación crónica podría influir en los niveles de hemoglobina glicosilada.</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>Además, se plantea que la exposición a óxidos de nitrógeno ($NOx$​) y dióxido de azufre ($SO_2$​) genera estrés oxidativo que eleva la homocisteína y exacerba los procesos inflamatorios. Por otro lado, la exposición al monóxido de carbono ($CO$) afecta la oxigenación, lo que se refleja en una disminución de la hemoglobina y en la función renal, evaluada con la creatinina.</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>En cuanto a los factores de estilo de vida, la dieta juega un papel crucial. Se propone que el consumo de carne roja está asociado con niveles elevados de ácido úrico, mientras que una dieta alta en grasas se correlaciona con el colesterol y los triglicéridos. Un consumo bajo de frutas y verduras se refleja en niveles deficientes de folato, vitamina B12 y vitamina D. La edad y el sexo también se consideran aspectos relevantes en el desarrollo de enfermedades: la edad se relaciona directamente con los niveles de glucosa e insulina, mientras que el sexo influye en la ferritina y la hemoglobina. Finalmente, se postula que vivir en zonas urbanas (representado por el estrato social) influye directamente en el perfil metabólico e inflamatorio debido a una mayor exposición a la contaminación.</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a><span class="fu">### DAG 3: Propuesta por el médico geriatra Jesús Francisco Gutiérrez Suárez.</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a><span class="al">![Grafo Acíclico Dirigido 3](dag_3.png)</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>Este modelo establece que las variables demográficas, como el sexo y la edad, son los nodos principales que influyen en los perfiles metabólicos, afectando directamente los niveles de colesterol LDL, colesterol total, triglicéridos y glucosa.</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>El modelo propone que la **exposición a contaminantes del aire**, como el monóxido de carbono (CO), el dióxido de azufre ($SO_2$​) y el amoníaco ($NH_3$​), está determinada por el estrato socioeconómico y la región. La **hemoglobina** es un biomarcador clave en esta estructura, ya que se encuentra en el centro de las dependencias, siendo influenciada por una combinación de factores ambientales ($CO$, $NOx$​), demográficos (sexo, edad, región) y nutricionales (ferritina, folato, vitamina B12). Finalmente, los indicadores de salud a largo plazo, como la **hemoglobina glicosilada**, dependen de las interacciones entre el sexo, la edad y los niveles de hemoglobina y glucosa.</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>En resumen, los tres modelos de DAGs coinciden en estructurar las variables sociodemográficas como puntos de partida, de modo que sexo, edad y región siempre aparecen como nodos iniciales, y en todos los casos se observa que variables metabólicas como glucosa, colesterol total, hemoglobina o insulina son consideradas desenlaces intermedios o finales. Sin embargo, difieren en cómo se asignan los papeles de mediación: por ejemplo, en un modelo *estrato* funciona como nexo entre municipio y hemoglobina, reflejando un interés en capturar determinantes sociales de la salud; mientras que en otro se enfatiza la ruta bioquímica al ligar proteína C reactiva con glucosa y colesterol, sugiriendo una perspectiva más biomédica que prioriza la inflamación como factor central. De forma similar, un modelo coloca a la albúmina como variable puente entre $CO$ y hemoglobina glicosilada, mientras que en otro este rol lo asume la insulina, mostrando dos formas distintas de concebir la relación entre metabolismo energético y marcadores de función hepática. Estas diferencias probablemente se deben a que cada investigador pondera de manera distinta la evidencia previa: quienes priorizan variables sociales construyen DAGs más jerárquicos con capas de contexto (municipio, estrato), mientras que quienes priorizan la fisiología molecular trazan rutas más directas entre biomarcadores. En resumen, los puntos en común muestran un consenso en las variables clave, pero las divergencias reflejan enfoques disciplinarios y prioridades teóricas distintas.</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ajuste de cada modelo a una GBN y métricas BIC y AIC </span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>A partir de cada DAG, se procedió a realizar su ajuste a una Red Bayesiana Gaussiana utilizando la librería <span class="in">`bnlearn`</span> de R. Sin embargo, en este lenguaje las GBN solo pueden ajustarse con variables continuas; no es posible incluir directamente variables discretas como sexo, estrato o región. Por ello, los intentos de ajustar una GBN con estas variables fallaron, y los criterios de información Bayesiano y de Akaike (BIC y AIC) solo funcionan para nodos continuos. Estas redes están diseñadas para trabajar con variables que siguen una distribución gaussiana, es decir, continuas. Los modelos DAG que se propusieron tienen condicionales gaussianas mixtas, las CG-BN (condicionales gaussianas mixtas) en <span class="in">`bnlearn`</span> no son soportadas para ajuste automático con variables discretas, al menos sin usar paquetes avanzados.</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>Ante lo anterior, se convirtieron las variables discretas en un factor, aunque esto no cambia el hecho de que su naturaleza es categórica. Ya que los modelos GBN puros asumen que todas las relaciones entre las variables son lineales y pueden ser representadas por regresiones lineales, lo que no es posible con variables discretas o categóricas, probar esta técnica tampoco produjo buenos resultados. Después de una investigación más exhaustiva, se encontró que los intentos de ajustar las estructuras DAG propuestas directamente como una GBN pura fallarán en R porque incluyen variables categóricas, y los criterios de información BIC o AIC no son compatibles con nodos discretos, lo que hace necesario explorar enfoques más avanzados o alternativos para el análisis.</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a><span class="fu">### Selección del modelo</span></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>Al comparar los valores obtenidos, se eligió el **Modelo 2**, ya que presentó el **BIC y AIC más alto**, lo que indica un mejor equilibrio entre ajuste del modelo y complejidad.  </span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a><span class="al">![Grafo acíclico dirigido seleccionado](dag_seleccionada.png)</span></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>Este modelo refleja relaciones plausibles desde un punto de vista epidemiológico:  </span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Edad** influye en biomarcadores como colesterol total, ácido úrico, triglicéridos y creatinina, además de estar relacionada con glucosa, insulina y vitamina D.  </span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Municipio** concentra las conexiones con contaminantes ambientales ($CO$, $NOx$, $SO_2$, $PM_{10}$, $PM_{2.5}$) y micronutrientes (folato, vitamina B12), reflejando la variación espacial de exposición y condiciones ambientales.  </span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Variables como **hemoglobina glicosilada** y **proteína C-reactiva** aparecen al final de la red, recibiendo influencias de varios factores metabólicos y ambientales, lo que sugiere su papel como posibles variables de resultado o integración de riesgos.  </span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>En conjunto, la estructura del Modelo 2 muestra cómo las características demográficas (edad) y contextuales (municipio) actúan como determinantes principales sobre los biomarcadores de salud, lo que refuerza su pertinencia como modelo seleccionado.</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a><span class="fu">## Manejo de variables categóricas: el caso de sexo</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>Uno de los principales retos al construir redes bayesianas gaussianas con datos reales es la inclusión de variables categóricas, como sexo, región o estrato. Estos modelos están diseñados para trabajar con variables continuas, por lo que no es posible incluir directamente variables discretas sin perder validez estadística o recurrir a técnicas más avanzadas.</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>En este trabajo, fueron exploradas distintas alternativas para abordar este problema, ya que el sexo es una variable central por requerimiento de la tarea. Primero, se intentó discretizar variables continuas y convertir las categóricas en factores, pero esto no resolvió la incompatibilidad con la GBN pura. También se revisó la literatura sobre métodos mixtos, como el modelo condicional gaussiano (CLG) y otros enfoques más complejos, aunque no fueron implementados en este análisis por su mayor complejidad y restricciones de software.</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>Finalmente, para poder analizar la influencia del sexo y cumplir con el objetivo de comparar diferencias por género, se decidió **estratificar la base de datos**, ajustando una red separada para hombres y otra para mujeres. Esta estrategia, aunque sencilla, permitió identificar posibles diferencias en la estructura y los parámetros del modelo según sexo; sin embargo, también limita la posibilidad de analizar interacciones conjuntas entre variables categóricas y continuas.</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>En resumen, la imposibilidad de incluir variables categóricas en las GBN con <span class="in">`bnlearn`</span> concluyó en comparar subgrupos por separado. Dentro del equipo se reconoce que existen alternativas metodológicas para integrar datos mixtos en redes bayesianas, pero cada una implica distintas limitaciones y complejidades.</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a><span class="fu"># Aplicación</span></span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ajuste de los DAGs y cálculo de métricas de información</span></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>Las tres estructuras DAG propuestas inicialmente fueron ajustadas como Redes Bayesianas Gaussianas (GBN).  </span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>Debido a las limitaciones ya mencionadas —específicamente, la imposibilidad de incluir variables categóricas en un modelo GBN con <span class="in">`bnlearn`</span>— fue necesario **eliminar las variables `estrato`, `región` y `sexo`**, manteniendo únicamente **edad** y **municipio** como nodos válidos para el ajuste.  </span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>Con estas variables continuas se procedió a calcular los criterios de información **BIC (Bayesian Information Criterion)** y **AIC (Akaike Information Criterion)** para cada una de las tres redes propuestas.  </span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a><span class="fu">## Análisis de queries y predicciones</span></span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>Con el modelo seleccionado se implementaron **consultas probabilísticas (queries)** mediante la función <span class="in">`cpquery`</span> de <span class="in">`bnlearn`</span>.  </span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>El objetivo fue estimar **probabilidades condicionales** de variables de interés en presencia de ciertas condiciones ambientales o demográficas.  </span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>Para cada consulta:  </span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Se definió un **evento de interés clínico o epidemiológico** (ej. proteína C reactiva elevada, glucosa alta, colesterol elevado).  </span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Se establecieron las condiciones de **evidencia** (ej. exposición a contaminantes como $PM_{2.5}$, $NOx$ o $SO_{2}$, o pertenecer a un grupo de edad).  </span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Se utilizó el método de **simulación** con al menos $10^6$ muestras (<span class="in">`n = 10^6`</span>), lo que permitió obtener estimaciones robustas y estables de las probabilidades condicionales.  </span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a><span class="fu">## Análisis por sexo (estratificación)</span></span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>Con el objetivo de cumplir el requerimiento de comparar diferencias por sexo, la base de datos se dividió en dos subconjuntos: hombres y mujeres. Se ajustó una red bayesiana gaussiana por separado para cada grupo, utilizando la misma estructura DAG y las variables continuas seleccionadas. Para ambos modelos se calcularon los valores de BIC y AIC, así como los parámetros estimados de cada nodo, facilitando la comparación directa entre sexos.</span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelos no paramétricos y comparación AIC/BIC</span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>Fue respetada la estructura causal de la DAG y se sustituyó, nodo por nodo, los modelos lineales por **modelos aditivos generalizados (GAM)** usando *mgcv*. Para cada relación padre → hijo se especificó una función suave <span class="in">`s(·)`</span> que permite no linealidades. Por ejemplo:</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`vit_d ~ s(edad)`</span>  </span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`colesterol_total ~ s(edad)`</span>  </span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`CO ~ s(municipio)`</span>  </span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`proteina_cr ~ s(homocistenia) + s(PM_010) + s(PM_2_5)`</span>  </span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>Asimismo, se mantuvieron los nodos raíz como intercepto (<span class="in">`edad ~ 1`</span>). El nodo **municipio** se trató como exógeno (factor), sin modelarlo como respuesta.</span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>Para evaluar el ajuste global de la red, fueron agregados los criterios de información **nodo a nodo** y se reportó:</span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>\text{BIC}_{\text{bnlearn}} \;=\; \ell(\hat{\theta}; \mathbf{x}) \;-\; \frac{k}{2}\log(n),</span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>Con esta convención, los valores **más altos** indican mejor ajuste penalizado (equivalente a menores AIC/BIC totales).</span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2. Resultado principal  </span></span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>El ajuste no paramétrico obtuvo:</span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>| Modelo                         | <span class="sc">\(</span>BIC<span class="sc">\)</span> |</span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>|--------------------------------|-------------------------------|</span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>| DAG con modelos no paramétricos (GAM) | <span class="sc">\(</span>-5,133,520<span class="sc">\)</span>            |</span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a>| DAG con modelos paramétricos (lineales) | <span class="sc">\(</span>-5,176,757<span class="sc">\)</span>            |</span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>Por tanto, **el BIC no mejoró** al introducir suavizadores.</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a><span class="fu"># Resultados</span></span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resultados de BIC y AIC</span></span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>Las tres estructuras DAG ajustadas fueron evaluadas con los criterios de información **BIC** y **AIC**, considerando únicamente las variables socio-demográficas continuas (<span class="in">`edad`</span>, <span class="in">`municipio`</span> y <span class="in">`entidad`</span>), ya que <span class="in">`estrato`</span>, <span class="in">`región`</span> y <span class="in">`sexo`</span> fueron eliminadas por los problemas ya explicados.  </span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>| Modelo | BIC       | AIC       |</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>|--------|-----------|-----------|</span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>| DAG 1  | -3324833  | -3324649  |</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>| DAG 2  | -5176757  | -5176453  |</span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>| DAG 3  | -3801911  | -3801709  |</span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resultados de queries probabilísticas</span></span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a><span class="fu">### Consulta 1 · Proteína C Reactiva vs **$PM_{2.5}$**</span></span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>**Pregunta.** ¿Cuál es la probabilidad de que una persona tenga **proteína C reactiva &gt; 10 mg/L** dado que la concentración de **$PM_{2.5}$ $\leq$ 155 μg/m³**?</span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>\mathbb{P}<span class="sc">\!</span>\left(\text{proteina<span class="sc">\_</span>cr} &gt; 0.001 \;\middle|\; PM_{2.5} \leq 155 \,\mu\text{g}/\text{m}^3\right)</span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a><span class="fu">### Consulta 2 · Glucosa y contaminante del aire</span></span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>**Pregunta.** ¿Cuál es la probabilidad de que una persona tenga **glucosa en ayuno &gt; 126 mg/dL** dado que es **mayor o igual a 50 años** y está expuesta a **NOx &gt;= 40 ppb**?</span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>\mathbb{P}<span class="sc">\!</span>\left(\mathrm{glucosa}&gt;126\ \text{mg/dL}\ \middle|\ \mathrm{edad}\geq 50,\ NOx&gt;=40\ \text{ppb}\right) = 0.1798456</span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a><span class="fu">### Consulta 3 · Colesterol total y SO₂</span></span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>**Pregunta.** ¿Cuál es la probabilidad de que una persona tenga **colesterol total &gt; 130 mg/dL** dado un nivel de **SO₂ &gt;= 80 ppb**?</span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>\mathbb{P}<span class="sc">\!</span>\left(\mathrm{colesterol<span class="sc">\_</span>total}&gt;130\ \text{mg/dL}\ \middle|\ SO_2&gt;=80\ \text{ppb}\right) = 0.86975</span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparación de modelos por sexo</span></span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**BIC para hombres:** -2,427,498  </span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**BIC para mujeres:** -2,748,215  </span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>Se observaron diferencias en los parámetros de algunos nodos, como la influencia de la glucosa sobre la hemoglobina glicosilada, siendo mayor en mujeres que en hombres.</span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>| Parámetro                      | Hombres       | Mujeres      |</span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>|--------------------------------|--------------|--------------|</span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>| Intercepto                     | 4.644663     | 4.485266     |</span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a>| Glucosa                        | 0.008277     | 0.009983     |</span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a>| Insulina                       | -0.000236    | 0.001297     |</span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a>| Proteína C reactiva (proteina_cr) | 0.259740     | 0.251406     |</span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a>| Sigma (desviación estándar)    | 0.486344     | 0.498629     |</span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>Estos resultados sugieren que, para un mismo aumento en la glucosa, el incremento esperado en la hemoglobina glicosilada es mayor en mujeres que en hombres, lo que podría estar relacionado con diferencias fisiológicas.</span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a><span class="fu"># Resultados</span></span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a>Para esta etapa se trabajó nuevamente con el **DAG seleccionado**, sin realizar comparaciones adicionales por sexo, ya que estas variables categóricas no forman parte del modelo ajustado.  </span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a>Se aplicaron consultas probabilísticas para evaluar la relación entre biomarcadores y contaminantes ambientales, con los siguientes resultados:</span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a>La probabilidad estimada de que un individuo presente niveles elevados de proteína C reactiva bajo condiciones de PM₂.₅ menores o iguales a 155 μg/m³ es de **82.3%**. Esto indica que, incluso en escenarios donde la concentración de partículas finas se mantiene por debajo de este umbral, existe una alta probabilidad de respuesta inflamatoria medida por proteína C reactiva.</span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>En personas de **50 años o más** expuestas a concentraciones de $NOx$ iguales o superiores a 40 ppb, la probabilidad de presentar glucosa en ayuno mayor a 126 mg/dL (umbral diagnóstico de diabetes) es de **17.9%**. Este resultado refleja un riesgo moderado que podría estar asociado a la combinación de edad avanzada y exposición a contaminantes.</span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a>La probabilidad de presentar colesterol total elevado en condiciones de exposición a **SO₂ ≥ 80 ppb** es de **86.9%**. Esto sugiere una fuerte asociación entre altos niveles de dióxido de azufre y alteraciones en el perfil lipídico, lo cual es relevante para el riesgo cardiovascular.</span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusiones</span></span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>Para poder llevar a cabo experimientaciones con datos es de gran relevancia tener cierta noción sobre los datos con los que se están trabajando y con base en ello poder trazar los caminos más adecuados a seguir. En este caso, para la elaboración de este artículo, fue necesario la consulta con especialistas para así entender mejor las bases de datos con las que se trabaja y direccionar la investigación a un camino con mayor sentido, demostrando la suma importancia del trabajo colaborativo y multidisciplinario para la obtención de mejores resultados. El uso de redes bayesianas gaussianas permitió analizar la relación entre contaminantes ambientales y biomarcadores de salud en la población mexicana, a pesar de las limitaciones para incorporar variables categóricas de manera directa. La selección y ajuste de modelos reveló diferencias en la influencia de variables ambientales y demográficas sobre la salud, así como algunas variaciones por sexo. Estos resultados refuerzan la utilidad de los enfoques probabilísticos en salud pública y destacan la importancia de seguir explorando métodos más flexibles para integrar datos mixtos en futuros estudios.</span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a><span class="fu"># Referencias</span></span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a>Galera Capilla, M. I. (2020). Redes bayesianas: fundamentos teóricos y uso en R (Trabajo Fin de Grado, Universidad de Almería). Repositorio Institucional UAL. https://repositorio.ual.es/bitstream/handle/10835/19116/GALERA%20CAPILLA%2C%20MARIA%20ISABEL.pdf?sequence=1&amp;isAllowed=y</span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copiar al portapapeles" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>